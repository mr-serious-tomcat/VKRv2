Документация по проекту: 
Генератор экспертных заключений

1.	Цель проекта:

Проект представляет собой приложение для автоматической генерации экспертных заключений на основе данных из файлов с табличными данными. В процессе используются шаблоны документов в формате .docx, с автоматической заменой значений в шаблонах и сохранением документов в указанной директории.

2.	Описание функционала:

Программа выполняет следующие ключевые функции:
•	Загрузка данных из Excel-файла.
•	Парсинг диапазона строк из файла Excel.
•	Определение подходящего шаблона документа в зависимости от данных в Excel.
•	Замена в шаблоне текста на основе значений из Excel (в том числе динамическая замена конструкций).
•	Генерация имени документа на основе введенных данных и шаблона.
•	Сохранение созданных документов в указанную директорию.

3.	Используемые библиотеки и инструменты:

3.1.	Python

Проект написан на языке программирования Python, который был выбран благодаря своей гибкости и широким возможностям работы с различными библиотеками для обработки данных, работы с файлами и интерфейсами. Python имеет высокую совместимость с операционными системами Windows и Linux, что делает решение универсальным.

3.2.	Библиотеки:

•	os: Используется для работы с файловой системой, получения путей, работы с директориями и именами файлов.
•	re: Регулярные выражения для обработки строк, например, для извлечения дат и номеров из текста.
•	tkinter: Библиотека для создания графического пользовательского интерфейса (GUI). В данном проекте используется для создания окон, кнопок и ввода данных пользователем.
•	pandas: Используется для чтения и обработки данных из Excel файлов. Pandas предоставляет простые методы для работы с табличными данными, что идеально подходит для обработки больших массивов данных, таких как данные из Excel.
•	docx: Библиотека для работы с файлами Word (.docx). Она используется для загрузки шаблонов документов, замены текста в документе и сохранения измененного файла.

3.3.	Операционные системы

•	Windows и Linux: Приложение совместимо с обеими операционными системами благодаря использованию универсальных библиотек Python. Не используются платформо-зависимые решения, что делает программу легко переносимой.

4.	Описание основных функций

4.1. Функция parse_row_range(row_range_str)
Эта функция предназначена для парсинга диапазона строк из строки ввода. Пользователь может указать диапазон строк в формате, например, 6-11 или 4,6-11, и функция преобразует его в список номеров строк для дальнейшей обработки.

4.2. Функция determine_template(cell_content, template_dir)
Данная функция определяет, какой шаблон документа должен быть выбран в зависимости от содержания ячейки в Excel. Шаблон выбирается на основе ключевых слов (например, "постановление", "приказ", "закон" и т.д.) и наличия конструкций, таких как "в ред."

4.3. Функция replace_placeholders(doc, replacements)
Эта функция заменяет текстовые плейсхолдеры в документе на значения из Excel. Для каждого плейсхолдера в шаблоне (например, 7-13cellC, 7-14cellB, 7-15cellA) подставляются соответствующие значения из строки Excel.

4.4. Функция generate_document_name(first_word_input, cell_content, template_path)
Функция для создания имени документа на основе введенного пользователем первого слова, содержимого ячейки и пути к шаблону. Также она извлекает дату и номер из текста для формирования имени.

4.5. Функция replace_forbidden_characters(file_name)
Эта функция заменяет все запрещенные символы в имени файла (например, \, /, :, *, и т.д.) на дефисы (-), чтобы имя файла было допустимым в операционной системе.

5.	Графический интерфейс

Графический интерфейс пользователя (GUI) разработан с использованием библиотеки tkinter. Интерфейс состоит из нескольких шагов:

-Выбор Excel файла для загрузки;
-Выбор листа Excel для обработки;
-Ввод диапазона строк;
-Выбор директории с шаблонами;
-Выбор директории для сохранения сгенерированных документов;
-Ввод первого слова для формирования имени документа;
-Каждое поле сопровождается кнопками для выбора файла или директории через стандартные диалоговые окна, а также кнопкой для начала процесса генерации документов;

6.	Алгоритм работы приложения:
-Пользователь загружает Excel файл, выбирает нужный лист и указывает диапазон строк;
-Программа находит соответствующие шаблоны документов в выбранной директории;
-Для каждой строки в диапазоне программа извлекает данные и подставляет их в шаблон;
-Заменяются плейсхолдеры, такие как 7-13cellC, на значения из Excel;
-Генерируется имя документа, которое включает в себя дату, номер и другие данные из строки;
-Документ сохраняется в выбранной директории. Если файл с таким именем уже существует, к имени добавляется префикс "D" для избежания перезаписи;


7. Обоснование выбора инструментов

7.1. Язык Python
Python выбран за свою простоту и гибкость. Он имеет богатую экосистему библиотек, что позволяет легко решать задачи, связанные с обработкой данных, манипулированием текстом и созданием GUI. Кроме того, Python является кроссплатформенным языком, что позволяет запустить приложение как на Windows, так и на Linux без существенных изменений. Это важно, так как наиболее распространённые отечественные операционные системы основаны на архитектуре Linux. Проводимая политика импортозамещения наряду с широким распространением в государственном управлении обеих архитектур исключает возможность использования некоторых языков программирования, например VBA. 

7.2. Библиотеки
•	Pandas идеально подходит для работы с табличными данными. Это одна из самых мощных библиотек для анализа данных в Python, с помощью которой удобно читать данные из Excel.
•	Tkinter является стандартной библиотекой Python для создания графических интерфейсов, что делает приложение простым и доступным для конечного пользователя.
•	python-docx используется для работы с .docx файлами, что является основным форматом для шаблонов в проекте.

8.	 Заключение

Проект представляет собой универсальное решение для автоматизированной генерации документов, которое подходит как для Windows, так и для Linux. Используемые инструменты, такие как Python и библиотеки для обработки Excel и Word файлов, позволяют эффективно решать поставленные задачи. GUI обеспечивает удобное взаимодействие с пользователем, минимизируя необходимость в технических знаниях для работы с приложением.

